/*!
 * ctrly v0.1.0 (2018-08-21)
 * Copyright (c) 2018 Jan Sorgalla
 * License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.ctrly=t()}(this,function(){"use strict";function p(){try{var e=document.activeElement;return e&&e.nodeName?e:document.body}catch(e){return document.body}}function v(e){var t,n;(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).restoreScrollPosition&&(n=function(e){for(var t=[];e&&e.parentNode&&1===e.parentNode.nodeType;)e=e.parentNode,t.push(e);return t}(e).map(function(e){return{element:e,top:e.scrollTop,left:e.scrollLeft}}),t=function(){n.forEach(function(e){var t=e.element,n=e.top,o=e.left;t.scrollTop=n,t.scrollLeft=o})});try{e.focus()}catch(e){}t&&t()}function h(e,t){var n=1<arguments.length?t:document;return n&&"function"==typeof n.querySelectorAll?[].slice.call(n.querySelectorAll(e)):[]}function n(e,t){if(!e)return!1;var n=e.matches||e.webkitMatchesSelector||e.msMatchesSelector;return"function"==typeof n&&n.call(e,t)}function b(e,t){if(!e)return null;if("function"==typeof e.closest)return e.closest(t);do{if(n(e,t))return e;e=e.parentNode}while(e&&1===e.nodeType);return null}var t;function i(){if(t)return t;t={capture:!1,once:!1,passive:!1};var e={get capture(){return!(t.capture=!0)},get once(){return!(t.once=!0)},get passive(){return!(t.passive=!0)}};return window.addEventListener("test",e,e),window.removeEventListener("test",e,e),t}function u(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=i(),n=t.once,o=t.passive,r=t.capture;return n||o||r?(n||delete e.once,o||delete e.passive,r||delete e.capture,e):Boolean(e.capture)}function m(t,e,n){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{capture:!1};if(!t||"function"!=typeof t.addEventListener)return function(){};var r=n,c=function(){!function(e,t,n){var o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{capture:!1};e&&"function"==typeof e.removeEventListener&&e.removeEventListener(t,n,u(o))}(t,e,r,o)};return o.once&&!i().once&&(r=function(e){c(),n.call(t,e)}),t.addEventListener(e,r,u(o)),c}var y={selector:"[data-ctrly]",context:null,focusTarget:!0,closeOnEsc:!0,closeOnOutsideClick:!0,closeOnScroll:!1,constrainFocus:!1,allowMultiple:!1,on:null},E='a[href],area[href],input:not([disabled]),select:not([disabled]),textarea:not([disabled]),button:not([disabled]),iframe,object,embed,[contenteditable],[tabindex]:not([tabindex^="-"])',g={passive:!0};function w(e){return"which"in e?e.which:e.keyCode}function A(e){var t=e.getAttribute("aria-controls");return document.getElementById(t)}return function(){var n,o,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=(n={},[y,e].forEach(function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])}),n),l=a.selector,r=a.on||{},s={};function d(e,t){return("function"!=typeof r[t]||!1!==r[t](e))&&!1!==function(e,t){var n,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};if(!e||"function"!=typeof e.dispatchEvent)return!0;o.bubbles=o.bubbles||!1,o.cancelable=o.cancelable||!1,o.composed=o.composed||!1,o.detail=o.detail||null;try{n=new CustomEvent(t,o)}catch(e){(n=document.createEvent("CustomEvent")).initCustomEvent(t,o.bubbles,o.cancelable,o.detail)}return e.dispatchEvent(n)}(e,"ctrly:".concat(t),{bubbles:!0,cancelable:!0})}function f(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=A(e);if(!n)return!1;if(!n.hasAttribute("data-ctrly-opened"))return!1;if(!d(n,"close"))return!1;var o=p();return s[n.id]&&(s[n.id](),delete s[n.id]),h('[aria-controls="'.concat(n.id,'"]')).forEach(function(e){e.setAttribute("aria-expanded","false")}),n.removeAttribute("data-ctrly-opened"),n.setAttribute("aria-hidden","true"),n.removeAttribute("tabindex"),n.blur(),t&&n.contains(o)&&v(e,{restoreScrollPosition:!0}),d(n,"closed"),n}function c(t){var e;h(l,(e=t,a.context?b(e,a.context):document)).forEach(function(e){e!==t&&f(e,!1)})}function i(e){var t,c,n,o,r,i,u=A(e);return!!u&&!u.hasAttribute("data-ctrly-opened")&&!!d(u,"open")&&(s[u.id]=(t=e,c=u,o=!(n=[]),r=function(){o=!0},i=function(){o=!1},(a.closeOnOutsideClick||a.closeOnScroll)&&(n.push(m(c,"mouseenter",r,g)),n.push(m(c,"mouseleave",i,g)),n.push(m(c,"touchstart",r,g)),n.push(m(c,"touchend",i,g))),a.closeOnEsc&&n.push(m(document,"keydown",function(e){27===w(e)&&f(t)&&e.preventDefault()})),a.closeOnOutsideClick&&n.push(m(document,"click",function(e){o||1!==w(e)||b(e.target,l)||f(t)},g)),a.closeOnScroll&&n.push(m(window,"scroll",function(){o||f(t)},g)),a.constrainFocus&&n.push(m(document,"keydown",function(e){if(9===w(e)){var t=h(E,c);if(!t[0])return e.preventDefault(),void v(c);var n=p(),o=t[0],r=t[t.length-1];if(e.shiftKey&&n===o)return e.preventDefault(),void v(r);e.shiftKey||n!==r||(v(o),e.preventDefault())}})),function(){for(;n.length;)n.shift().call()}),h('[aria-controls="'.concat(u.id,'"]')).forEach(function(e){e.setAttribute("aria-expanded","true")}),u.setAttribute("data-ctrly-opened",""),u.setAttribute("aria-hidden","false"),u.setAttribute("tabindex","-1"),d(u,"opened"),u)}function t(){var e,t;o||(o=function(e,t,n,o){var r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:{capture:!1},c=!0===r.once;delete r.once;var i=m(e,t,function(e){var t=b(e.target,n);t&&(c&&i(),o.call(t,e,t))},r);return i}(document,"click",l,function(e,t){if(1===w(e))if("true"!==t.getAttribute("aria-expanded")){a.allowMultiple||c(t);var n=i(t);n&&(e.preventDefault(),a.focusTarget&&v(h(E,n)[0]||n),n.scrollTop=0,n.scrollLeft=0)}else f(t)&&e.preventDefault()})),e=function(){h(l).forEach(function(e){if("true"!==e.getAttribute("aria-expanded")){e.setAttribute("aria-expanded","false");var t=A(e);t&&t.setAttribute("aria-hidden","true")}else i(e)})},"complete"!==(t=document.readyState)&&"interactive"!==t?document.addEventListener("DOMContentLoaded",function(){e()},u({capture:!0,once:!0,passive:!0})):setTimeout(e,0)}return t(),{init:t,destroy:function(){for(var e in o&&(o(),o=null),h(l).forEach(function(e){f(e,!1)}),s)Object.prototype.hasOwnProperty.call(s,e)&&s[e].call()}}}});
